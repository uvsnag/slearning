(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2579,12233,e=>{"use strict";let t={notify:{sheetDefault:"Notify!A2:C500"},listen:{sheetDefault:"Notify!Y2:AA500"},apiKey:"AIzaSyBtOYQ3DJeBSo75u8BlwCToYh-kjowXaFA",clientId:"897570143608-dvfjhqfsi125cne619dvu3qqfdep6ui6.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/spreadsheets",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],spreadsheetId:"1w_LXJm2Vsw11IlhyuwaMJEWQLT36kgrJ3fJUQwA37fg"};e.s(["default",0,t],12233);var a=e.i(28337),s=e.i(80642);let n="STORE_E",l=[{range:"Notify!A2:C500",name:"Board1"},{range:"Notify!E2:G500",name:"Board2"},{range:"Notify!I2:K500",name:"Board3"},{range:"Notify!M2:O500",name:"Board4"},{range:"Notify!Q2:S500",name:"Board5"},{range:"Notify!U2:W500",name:"Board6"},{range:"Notify!Y2:AA500",name:"Board7"},{range:"Batch1!A2:B500",name:"B1Board1"},{range:"Batch1!D2:E500",name:"B1Board2"},{range:"Batch1!G2:H500",name:"B1Board3"},{range:"Batch1!J2:K500",name:"B1Board4"},{range:"Batch1!M2:N500",name:"B1Board5"},{range:"Batch1!P2:Q500",name:"B1Board6"},{range:"Batch1!S2:T500",name:"B1Board7"},{range:"Batch1!V2:W500",name:"B1Board8"},{range:"Batch1!Y2:Z500",name:"B1Board9"},{range:"Batch1!AB2:AC500",name:"B1Board10"},{range:"Batch2!A2:B500",name:"B2Board1"},{range:"Batch2!G2:H500",name:"B2Board3"},{range:"Batch2!J2:K500",name:"B2Board4"},{range:"Batch2!M2:N500",name:"B2Board5"},{range:`${n}1`,name:"Store1"},{range:`${n}2`,name:"Store2"},{range:`${n}3`,name:"Store3"}],i=async(e,n)=>e.client.sheets.spreadsheets.values.get({spreadsheetId:localStorage.getItem(s.KEY_GOOGLE_SHEET_NM)?localStorage.getItem(s.KEY_GOOGLE_SHEET_NM):t.spreadsheetId,range:a.default.isEmpty(n)?t.notify.sheetDefault:n}),o=async(e,t,s)=>{e.client.load("sheets","v4",async()=>{let n=await i(e,s);console.log("Response",n);let l=n.result?.values;t(l?.filter(e=>!a.default.isEmpty(e)).filter(e=>!a.default.isEmpty(e[0])).map(e=>({eng:e[0],vi:e[1],customDefine:e[2]}))||[])})},r=async(e,a,n,l,i)=>{let o=await e.auth2.getAuthInstance();o.isSignedIn.get()||await o.signIn(),e.client.load("sheets","v4",()=>{let o=localStorage.getItem(s.KEY_GOOGLE_SHEET_NM)?localStorage.getItem(s.KEY_GOOGLE_SHEET_NM):t.spreadsheetId,r=`${n}!${l}`;e.client.sheets.spreadsheets.values.update({spreadsheetId:o,range:r,valueInputOption:"USER_ENTERED",resource:{values:[[i]]}}).then(e=>{a&&a({success:!0,updates:e.result.updates})})})},c=async(a,s,n,l,i)=>{let{gapi:c}=await e.A(6857);c.load("client:auth2",async()=>{await c.client.init({apiKey:t.apiKey,clientId:t.clientId,discoveryDocs:t.discoveryDocs,scope:t.scope}),"get"===n&&await c.client.load("sheets","v4",async()=>{o(c,a,s)}),"update"===n&&r(c,a,s,l||"A1",i||"")})},u=async(e,t)=>{if(e?.startsWith(n)){let s=localStorage.getItem(e),n=s?JSON.parse(s):[];a.default.isEmpty(n)||t(n)}else await c(t,e,"get")};async function d(e,t,a){if(a?.startsWith(n)){let t=localStorage.getItem(a),s=t?JSON.parse(t):[];s=s.filter(t=>t.eng!=e),localStorage.setItem(a,JSON.stringify([...s]))}else await h({callback:e=>{e?.success?console.log("Data saved successfully!"):console.log("Failed to save data")},range:a,value1:"",value2:"",updateWhenEquals:e});t()}let h=async({callback:n,range:l,value1:i,value2:o,updateWhenEquals:r=null})=>{console.log("Update GG Sheet:",{range:l,value1:i,value2:o,updateWhenEquals:r}),l.startsWith("AUTO")||(r=null);let{gapi:c}=await e.A(6857);c.load("client:auth2",async()=>{await c.client.init({apiKey:t.apiKey,clientId:t.clientId,discoveryDocs:t.discoveryDocs,scope:t.scope});let e=await c.auth2.getAuthInstance();e.isSignedIn.get()||await e.signIn(),c.client.load("sheets","v4",async()=>{let e=localStorage.getItem(s.KEY_GOOGLE_SHEET_NM)?localStorage.getItem(s.KEY_GOOGLE_SHEET_NM):t.spreadsheetId,u=l.split("!"),d=u[0],h=(u[1]?.split(":")[0]||"A2").match(/([A-Z]+)(\d+)/);if(!h){n&&n({success:!1,error:"Invalid cell format"});return}let m=h[1],g=parseInt(h[2],10),p=(e=>{let t="",a=1;for(let s=e.length-1;s>=0;s--){let n=e.charCodeAt(s)+a;n>90?(n=65,a=1):a=0,t=String.fromCharCode(n)+t}return a&&(t="A"+t),t})(m);try{let t=await c.client.sheets.spreadsheets.values.get({spreadsheetId:e,range:l}),s=t.result?.values||[],u=g;for(let e=0;e<s.length;e++){let t=s[e];if(r){if(t&&t.length>0&&t[0]===r){u=g+e;break}}else if(!t||0===t.length||a.default.isEmpty(t[0])){u=g+e;break}e===s.length-1&&(u=g+s.length)}0===s.length&&(u=g);let h=`${d}!${m}${u}:${p}${u}`;c.client.sheets.spreadsheets.values.update({spreadsheetId:e,range:h,valueInputOption:"USER_ENTERED",resource:{values:[[i,o]]}}).then(e=>{n&&n({success:!0,updates:e.result.updates})}).catch(e=>{n&&n({success:!1,error:e.message})})}catch(e){n&&n({success:!1,error:e.message||"Failed to read sheet data"})}})})};e.s(["SHEET_LIST",0,l,"STORE_ALIAS",0,n,"getDataFromExcel",0,u,"ggSheetUpdateTwoValues",0,h,"onRemoveStoreItem",()=>d],2579)},72066,e=>{"use strict";var t=e.i(80744);function a(e){let[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)(!1),[i,o]=(0,t.useState)(!1),r="speechSynthesis"in window;(0,t.useEffect)(()=>{if(!r)return;let e=window.speechSynthesis,t=()=>{s(e.getVoices())};return s(e.getVoices()),e.addEventListener("voiceschanged",t),()=>{e.removeEventListener("voiceschanged",t)}},[r]);let c=(0,t.useCallback)(t=>{if(!r)return;let a=window.speechSynthesis;t.onstart=()=>l(!0),t.onend=()=>{l(!1),o(!1),e?.onEnd?.()},t.onerror=()=>l(!1),a.cancel(),a.speak(t)},[r,e]),u=(0,t.useCallback)(()=>{r&&(window.speechSynthesis.cancel(),l(!1),o(!1))},[r]),d=(0,t.useCallback)(()=>{r&&n&&(window.speechSynthesis.pause(),o(!0))},[r,n]);return{speak:c,speakText:(e,t,s)=>{let n=s.voice||"0",l=s.voice||"0",i=s.rate||"0.6",o=new window.SpeechSynthesisUtterance;o.text=e,o.rate=Number(i),t?o.voice=a[Number(n)]:o.voice=a[Number(l)],o.volume=s.volume,c(o)},cancel:u,pause:d,resume:(0,t.useCallback)(()=>{r&&i&&(window.speechSynthesis.resume(),o(!1))},[r,i]),speaking:n,paused:i,supported:r,voices:a}}e.s(["useSpeechSynthesis",()=>a])},51214,e=>{"use strict";var t=e.i(71866),a=e.i(80744),s=e.i(28337),n=e.i(97968),l=e.i(12233),i=e.i(2579),o=e.i(72066);e.s(["default",0,()=>{let e=l.default.listen.sheetDefault,[r,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[f,v]=(0,a.useState)([]),[y,E]=(0,a.useState)([]),[S,B]=(0,a.useState)(0),[w,x]=(0,a.useState)(),[N,I]=(0,a.useState)([]),[j,A]=(0,a.useState)([]),[b,D]=(0,a.useState)(.9),[C,O]=(0,a.useState)(""),{speak:_,voices:T}=(0,o.useSpeechSynthesis)();(0,a.useEffect)(()=>{(0,i.getDataFromExcel)(e,k)},[]),(0,a.useEffect)(()=>{if(s.default.isEqual(w,"-1")){let e=N.filter(e=>e.eng===r);s.default.isEmpty(e)||A(N.filter(t=>t.customDefine===e[0].customDefine))}else A(N);let e=e=>{"Space"===e.code&&K(r,!0)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r]),(0,a.useEffect)(()=>{U()},[N]),(0,a.useEffect)(()=>{if(s.default.isEmpty(f))return;let e=-1,t=[];f.forEach(a=>{s.default.isEmpty(a.customDefine)||a.customDefine===e||(t.push(a),e=a.customDefine)}),E(t),x("-1")},[f]),(0,a.useEffect)(()=>{T.forEach((e,t)=>{e.lang.includes("en-US")&&B(t)})},[T]),(0,a.useEffect)(()=>{s.default.isEmpty(u)||G()},[u]),(0,a.useEffect)(()=>{let e=[];"-1"===w?e=f:f.forEach(t=>{t.customDefine===w&&e.push(t)}),I(e)},[w]);let k=(e,t)=>{if(e){let t=[];e.items.forEach(e=>{s.default.isEmpty(e)||s.default.isEmpty(e.eng)||t.push(e)}),v(t)}else console.log(t)},U=()=>{if(!s.default.isEmpty(N)){let e=N[Math.random()*N.length|0];c(e.eng),K(e.eng,!0),p(""),d("")}},G=()=>{if(!s.default.isNull(u))if(u.trim().toUpperCase()===r.toUpperCase().trim()){U(),m("correct!");let e=document.getElementById("answer");e&&(e.value=""),O(u)}else m("wrong!")},K=(e,t)=>{let a=document.getElementById("voice")?.value,s=document.getElementById("rate")?.value,n=new window.SpeechSynthesisUtterance;n.text=e,n.rate=Number(s),t&&void 0!==a&&(n.voice=T[Number(a)]),n.volume=1,_(n)};return(0,t.jsxs)("div",{className:"prac",children:[(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("select",{className:"button-33",onChange:e=>x(e.target.value),children:[(0,t.jsx)("option",{value:"-1",children:"All Word"}),y.map(e=>(0,t.jsx)("option",{value:e.customDefine,children:e.eng},e.eng))]}),(0,t.jsxs)("select",{className:"button-33 inline",id:"voice",value:S||"",onChange:e=>B(Number(e.target.value)),children:[(0,t.jsx)("option",{value:"",children:"Default"}),T.map((e,a)=>(0,t.jsx)("option",{value:a,children:`${e.lang} - ${e.name}`},e.voiceURI))]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:12},children:[(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,t.jsx)("label",{htmlFor:"rate",children:"Speed: "}),(0,t.jsx)("div",{className:"rate-value",children:b})]}),(0,t.jsx)("input",{type:"range",className:"width-220 range-color",min:"0.2",max:"2",defaultValue:"0.6",step:"0.1",id:"rate",onChange:e=>D(Number(e.target.value))})]}),(0,t.jsx)("div",{children:!s.default.isEmpty(r)&&(0,t.jsx)(n.FaVolumeUp,{className:"iconSound",onClick:()=>K(r,!0)})})]}),(0,t.jsx)("input",{type:"text",id:"answer",onKeyDown:e=>{"Enter"===e.key&&d(e.currentTarget.value)}}),(0,t.jsx)("br",{}),(0,t.jsxs)("select",{className:"button-33",onChange:e=>{d(e.target.value)},value:u||"",children:[(0,t.jsx)("option",{value:"",children:"Choose"}),j.map(e=>(0,t.jsx)("option",{value:e.eng,children:e.eng},e.eng))]}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{className:"msg",children:"wrong!"===h?(0,t.jsx)(n.FaRegFrown,{}):(0,t.jsx)(n.FaRegSmile,{})}),h,(0,t.jsx)("br",{}),(0,t.jsx)("input",{className:"button-33",type:"submit",value:"Check",onClick:G}),j.map(e=>(0,t.jsxs)("div",{children:[e.eng,(0,t.jsx)(n.FaVolumeUp,{className:"iconSound",onClick:()=>K(e.eng,!0)})]},e.eng)),(0,t.jsx)("input",{className:"common-btn",type:"submit",value:"Show Ans",onClick:()=>{p(s.default.isEmpty(g)?r:"")}}),(0,t.jsx)("div",{children:g}),!s.default.isEmpty(C)&&(0,t.jsxs)("div",{children:["Last : ",C,(0,t.jsx)(n.FaVolumeUp,{className:"iconSound",onClick:()=>K(C,!0)})]})]})}])},93195,e=>{e.n(e.i(51214))},6857,e=>{e.v(t=>Promise.all(["static/chunks/26dcfe4c23645568.js"].map(t=>e.l(t))).then(()=>t(17833)))}]);